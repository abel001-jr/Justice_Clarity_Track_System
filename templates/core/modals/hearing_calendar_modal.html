<!-- Hearing Calendar Modal -->
<div class="modal fade" id="hearingCalendarModal" tabindex="-1" aria-labelledby="hearingCalendarModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header clerk-modal">
                <h5 class="modal-title" id="hearingCalendarModalLabel">
                    <i class="bi bi-calendar-week me-2"></i>
                    Hearing Calendar
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Calendar Navigation -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-primary" onclick="changeView('month')">Month</button>
                            <button type="button" class="btn btn-outline-primary" onclick="changeView('week')">Week</button>
                            <button type="button" class="btn btn-outline-primary" onclick="changeView('day')">Day</button>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-secondary" onclick="previousPeriod()">
                                <i class="bi bi-chevron-left"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary" onclick="today()">Today</button>
                            <button type="button" class="btn btn-outline-secondary" onclick="nextPeriod()">
                                <i class="bi bi-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Calendar Header -->
                <div class="calendar-header mb-3">
                    <h4 id="calendarTitle" class="text-center">January 2024</h4>
                </div>

                <!-- Calendar Grid -->
                <div class="calendar-container">
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Upcoming Hearings List -->
                <div class="mt-4">
                    <h6 class="text-primary mb-3">
                        <i class="bi bi-calendar-event me-2"></i>
                        Upcoming Hearings
                    </h6>
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>Date & Time</th>
                                    <th>Case Number</th>
                                    <th>Type</th>
                                    <th>Judge</th>
                                    <th>Location</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div>Jan 25, 2024</div>
                                        <small class="text-muted">09:00 AM</small>
                                    </td>
                                    <td>
                                        <strong>CR-2024-001</strong>
                                        <div class="text-muted">State vs. Johnson</div>
                                    </td>
                                    <td>
                                        <span class="badge bg-primary">Initial Hearing</span>
                                    </td>
                                    <td>Judge Smith</td>
                                    <td>Courtroom A</td>
                                    <td>
                                        <span class="badge bg-warning">Scheduled</span>
                                    </td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-outline-primary" title="View Details">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                            <button class="btn btn-outline-secondary" title="Edit">
                                                <i class="bi bi-pencil"></i>
                                            </button>
                                            <button class="btn btn-outline-danger" title="Cancel">
                                                <i class="bi bi-x-circle"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div>Jan 26, 2024</div>
                                        <small class="text-muted">02:00 PM</small>
                                    </td>
                                    <td>
                                        <strong>CR-2024-002</strong>
                                        <div class="text-muted">State vs. Davis</div>
                                    </td>
                                    <td>
                                        <span class="badge bg-info">Evidence Hearing</span>
                                    </td>
                                    <td>Judge Johnson</td>
                                    <td>Courtroom B</td>
                                    <td>
                                        <span class="badge bg-warning">Scheduled</span>
                                    </td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-outline-primary" title="View Details">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                            <button class="btn btn-outline-secondary" title="Edit">
                                                <i class="bi bi-pencil"></i>
                                            </button>
                                            <button class="btn btn-outline-danger" title="Cancel">
                                                <i class="bi bi-x-circle"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div>Jan 27, 2024</div>
                                        <small class="text-muted">10:30 AM</small>
                                    </td>
                                    <td>
                                        <strong>CR-2024-003</strong>
                                        <div class="text-muted">State vs. Wilson</div>
                                    </td>
                                    <td>
                                        <span class="badge bg-success">Sentencing</span>
                                    </td>
                                    <td>Judge Brown</td>
                                    <td>Courtroom C</td>
                                    <td>
                                        <span class="badge bg-warning">Scheduled</span>
                                    </td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-outline-primary" title="View Details">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                            <button class="btn btn-outline-secondary" title="Edit">
                                                <i class="bi bi-pencil"></i>
                                            </button>
                                            <button class="btn btn-outline-danger" title="Cancel">
                                                <i class="bi bi-x-circle"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="{% url 'court:hearing_create' %}" class="btn btn-clerk-primary">
                    <i class="bi bi-calendar-plus me-2"></i>
                    Schedule New Hearing
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.calendar-container {
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    overflow: hidden;
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 1px;
    background: #dee2e6;
}

.calendar-day {
    background: white;
    min-height: 100px;
    padding: 0.5rem;
    position: relative;
}

.calendar-day.other-month {
    background: #f8f9fa;
    color: #6c757d;
}

.calendar-day.today {
    background: #e3f2fd;
    border: 2px solid var(--clerk-primary);
}

.calendar-day.has-events {
    background: #f0f8ff;
}

.calendar-day-header {
    font-weight: 600;
    margin-bottom: 0.5rem;
    text-align: center;
}

.calendar-event {
    background: var(--clerk-primary);
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    margin-bottom: 0.25rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.calendar-event:hover {
    background: #10b981;
    transform: scale(1.02);
}

.calendar-event.urgent {
    background: #dc3545;
}

.calendar-event.completed {
    background: #6c757d;
}

#hearingCalendarModal .table th {
    background: #f8f9fa;
    border-bottom: 2px solid #dee2e6;
    font-weight: 600;
}

#hearingCalendarModal .table td {
    vertical-align: middle;
}
</style>

<script>
let currentView = 'month';
let currentDate = new Date();

function changeView(view) {
    currentView = view;
    renderCalendar();
}

function previousPeriod() {
    switch (currentView) {
        case 'month':
            currentDate.setMonth(currentDate.getMonth() - 1);
            break;
        case 'week':
            currentDate.setDate(currentDate.getDate() - 7);
            break;
        case 'day':
            currentDate.setDate(currentDate.getDate() - 1);
            break;
    }
    renderCalendar();
}

function nextPeriod() {
    switch (currentView) {
        case 'month':
            currentDate.setMonth(currentDate.getMonth() + 1);
            break;
        case 'week':
            currentDate.setDate(currentDate.getDate() + 7);
            break;
        case 'day':
            currentDate.setDate(currentDate.getDate() + 1);
            break;
    }
    renderCalendar();
}

function today() {
    currentDate = new Date();
    renderCalendar();
}

function renderCalendar() {
    const grid = document.getElementById('calendarGrid');
    const title = document.getElementById('calendarTitle');
    
    // Update title
    title.textContent = currentDate.toLocaleDateString('en-US', { 
        month: 'long', 
        year: 'numeric' 
    });
    
    // Clear grid
    grid.innerHTML = '';
    
    // Add day headers
    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    days.forEach(day => {
        const dayHeader = document.createElement('div');
        dayHeader.className = 'calendar-day-header';
        dayHeader.textContent = day;
        grid.appendChild(dayHeader);
    });
    
    // Add calendar days
    const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
    const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
    const startDate = new Date(firstDay);
    startDate.setDate(startDate.getDate() - firstDay.getDay());
    
    for (let i = 0; i < 42; i++) {
        const date = new Date(startDate);
        date.setDate(startDate.getDate() + i);
        
        const dayElement = document.createElement('div');
        dayElement.className = 'calendar-day';
        
        if (date.getMonth() !== currentDate.getMonth()) {
            dayElement.classList.add('other-month');
        }
        
        if (date.toDateString() === new Date().toDateString()) {
            dayElement.classList.add('today');
        }
        
        // Add day number
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = date.getDate();
        dayElement.appendChild(dayNumber);
        
        // Add sample events
        if (date.getDate() === 25) {
            const event = document.createElement('div');
            event.className = 'calendar-event';
            event.textContent = 'CR-2024-001';
            event.title = 'Initial Hearing - State vs. Johnson';
            dayElement.appendChild(event);
            dayElement.classList.add('has-events');
        }
        
        if (date.getDate() === 26) {
            const event = document.createElement('div');
            event.className = 'calendar-event urgent';
            event.textContent = 'CR-2024-002';
            event.title = 'Evidence Hearing - State vs. Davis';
            dayElement.appendChild(event);
            dayElement.classList.add('has-events');
        }
        
        grid.appendChild(dayElement);
    }
}

// Initialize calendar when modal opens
document.addEventListener('DOMContentLoaded', function() {
    const calendarModal = document.getElementById('hearingCalendarModal');
    if (calendarModal) {
        calendarModal.addEventListener('shown.bs.modal', function() {
            renderCalendar();
        });
    }
});
</script>
